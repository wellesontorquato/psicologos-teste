<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Você está offline | PsiGestor</title>

  <link rel="icon" type="image/png" href="/favicon.png" />
  <meta name="theme-color" content="#00aaff" />

  <!-- (Opcional) Bootstrap via CDN. Se estiver offline, o CSS pode não carregar — por isso o layout
       abaixo NÃO depende do Bootstrap. -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        media="print"
        onload="this.media='all'">
  <noscript>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  </noscript>

  <style>
    :root{
      --brand:#00aaff;
      --brand-2:#0077ff;
      --bg:#f3f7fb;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:rgba(15,23,42,.10);
      --shadow: 0 10px 30px rgba(2, 32, 71, 0.10);
    }

    * { box-sizing: border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 24px;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      color: var(--text);
      background:
        radial-gradient(800px 400px at 20% 10%, rgba(0,170,255,.18), transparent 60%),
        radial-gradient(700px 380px at 80% 20%, rgba(0,119,255,.12), transparent 55%),
        linear-gradient(180deg, #f8fbff 0%, var(--bg) 100%);
    }

    .card{
      width: min(520px, 100%);
      background: rgba(255,255,255,.86);
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      padding: 22px;
      backdrop-filter: blur(10px);
      animation: pop .25s ease-out;
    }

    @keyframes pop{
      from{ opacity:0; transform: translateY(10px) scale(.98); }
      to{ opacity:1; transform: translateY(0) scale(1); }
    }

    .top{
      display:flex;
      align-items:center;
      gap:14px;
      margin-bottom: 10px;
    }

    .logo{
      width: 54px;
      height: 54px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(0,170,255,.18), rgba(0,119,255,.18));
      display:flex;
      align-items:center;
      justify-content:center;
      border: 1px solid rgba(0,170,255,.20);
      flex: 0 0 auto;
      overflow:hidden;
    }
    .logo img{
      width: 42px;
      height: 42px;
      object-fit: contain;
    }

    h1{
      font-size: 1.25rem;
      line-height: 1.2;
      margin: 0;
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .subtitle{
      margin: 4px 0 0 0;
      color: var(--muted);
      font-size: .95rem;
      line-height: 1.4;
    }

    .status{
      display:flex;
      align-items:center;
      gap:10px;
      margin: 14px 0 6px;
      padding: 12px 12px;
      border-radius: 14px;
      background: #f8fbff;
      border: 1px solid rgba(0,170,255,.15);
    }

    .dot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #f59e0b; /* amarelo: offline */
      box-shadow: 0 0 0 6px rgba(245,158,11,.14);
      flex: 0 0 auto;
    }

    .status strong{
      font-size: .95rem;
      font-weight: 800;
    }
    .status span{
      color: var(--muted);
      font-size: .9rem;
    }

    .actions{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }

    .btnx{
      appearance:none;
      border:0;
      border-radius: 12px;
      padding: 11px 14px;
      font-weight: 700;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      text-decoration:none;
      user-select:none;
      white-space: nowrap;
    }
    .btnx:active{ transform: translateY(1px); }

    .btn-primaryx{
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      color: #fff;
      box-shadow: 0 10px 20px rgba(0,170,255,.20);
    }
    .btn-primaryx:hover{ filter: brightness(0.98); }

    .btn-ghostx{
      background: #ffffff;
      border: 1px solid rgba(15,23,42,.10);
      color: var(--text);
    }
    .btn-ghostx:hover{ filter: brightness(0.99); }

    .hint{
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px dashed rgba(15,23,42,.12);
      color: var(--muted);
      font-size: .88rem;
      line-height: 1.4;
    }

    .small-row{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 10px;
      font-size: .85rem;
      color: var(--muted);
    }

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      padding: 2px 8px;
      border-radius: 10px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(15,23,42,.03);
      color: #334155;
      font-size: .82rem;
      white-space: nowrap;
    }

    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }
  </style>
</head>

<body>
  <main class="card" role="main" aria-live="polite">
    <div class="top">
      <div class="logo" aria-hidden="true">
        <picture>
          <source srcset="/icons/icon-192x192.webp" type="image/webp">
          <img
            src="/icons/icon-192x192.png"
            alt=""
            width="42"
            height="42"
            loading="lazy"
            onerror="this.onerror=null;this.src='/favicon.png';"
          >
        </picture>
      </div>

      <div>
        <h1>Você está offline</h1>
        <p class="subtitle">
          Sem conexão no momento. Assim que a internet voltar, o PsiGestor carrega normalmente.
        </p>
      </div>
    </div>

    <div class="status">
      <span class="dot" id="netDot" aria-hidden="true"></span>
      <div>
        <strong id="netTitle">Conexão indisponível</strong><br>
        <span id="netDesc">Verifique Wi-Fi/4G e tente novamente.</span>
      </div>
    </div>

    <div class="actions">
      <button class="btnx btn-primaryx" id="retryBtn" type="button">
        ⟳ Tentar novamente
      </button>

      <button class="btnx btn-ghostx" id="goHomeBtn" type="button" title="Ir para a página inicial">
        ⌂ Ir para o início
      </button>
    </div>

    <div class="small-row">
      <span>Atalho:</span>
      <span class="kbd">Ctrl</span> + <span class="kbd">R</span>
      <span style="opacity:.7">ou</span>
      <span class="kbd">⌘</span> + <span class="kbd">R</span>
    </div>

    <div class="hint">
      <strong>Dica:</strong> se você já abriu esta página antes, algumas partes podem continuar acessíveis offline.
      Quando a conexão voltar, esta tela sai automaticamente.
    </div>

    <p class="sr-only" id="srStatus"></p>
  </main>

  <script>
    (function () {
      const dot = document.getElementById("netDot");
      const title = document.getElementById("netTitle");
      const desc = document.getElementById("netDesc");
      const sr = document.getElementById("srStatus");

      const retryBtn = document.getElementById("retryBtn");
      const goHomeBtn = document.getElementById("goHomeBtn");

      function setOnlineUI(isOnline) {
        if (isOnline) {
          dot.style.background = "#22c55e";
          dot.style.boxShadow = "0 0 0 6px rgba(34,197,94,.16)";
          title.textContent = "Conexão restaurada";
          desc.textContent = "Atualizando…";
          sr.textContent = "Conexão restaurada. Atualizando a página.";
          // tenta sair do offline automaticamente
          setTimeout(() => location.reload(), 300);
        } else {
          dot.style.background = "#f59e0b";
          dot.style.boxShadow = "0 0 0 6px rgba(245,158,11,.14)";
          title.textContent = "Conexão indisponível";
          desc.textContent = "Verifique Wi-Fi/4G e tente novamente.";
          sr.textContent = "Você está offline.";
        }
      }

      retryBtn.addEventListener("click", () => location.reload());
      goHomeBtn.addEventListener("click", () => {
        // tenta ir para o início; se continuar offline, o SW devolve offline.html
        location.href = "/";
      });

      // estado inicial
      setOnlineUI(navigator.onLine);

      // muda automaticamente quando voltar a internet
      window.addEventListener("online", () => setOnlineUI(true));
      window.addEventListener("offline", () => setOnlineUI(false));
    })();
  </script>
</body>
</html>
